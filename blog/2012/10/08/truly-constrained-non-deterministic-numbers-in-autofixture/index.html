<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="Programmer using Test-Driven Development, C# and F#. Core Contributor to AutoFixture." name="Description" /><title>Truly Constrained Non-Deterministic Numbers in AutoFixture</title><link href="/stylesheets/styles.css?1406533649" media="screen" rel="stylesheet" type="text/css" /></head><body><div><div><p><a href="/">Nikos Baxevanis</a></p></div><div><h1>Truly Constrained Non-Deterministic Numbers in AutoFixture</h1><div>October 08, 2012 |  <a href="/category/autofixture/">AutoFixture</a></div></div><div><p>Numbers in <a href="https://github.com/autofixture/autofixture">AutoFixture</a> are currently created using a <strong>strictly monotonically increasing</strong> sequence.</p>
<pre class="highlight text">
var fixture = new Fixture();

var i = fixture.CreateAnonymous&lt;int&gt;();
// Prints -&gt; 1
var l = fixture.CreateAnonymous&lt;long&gt;();
// Prints -&gt; 2
var f = fixture.CreateAnonymous&lt;float&gt;();
// Prints -&gt; 3.0
</pre>
<p>Starting with version <em>2.13.0</em>, by applying a specific customization numbers can also be created using a <strong>constrained non-deterministic</strong> sequence. The new customization is called <code>RandomNumericSequenceCustomization</code>.</p>
<pre class="highlight text">var fixture = new Fixture()
    .Customize(new RandomNumericSequenceCustomization());

var i = fixture.CreateAnonymous&lt;int&gt;();
// Prints -&gt; 122
var l = fixture.CreateAnonymous&lt;long&gt;();
// Prints -&gt; 38
var f = fixture.CreateAnonymous&lt;float&gt;();
// Prints -&gt; 147.0
</pre>
<p>Once the customization has been applied to a <code>Fixture</code> instance subsequent requests for numeric types will yield random non-repeatable numbers in the range of [1, 255]. When requesting more than 255 numbers the range is automatically changed to [256, 32767] and so on.</p>

<blockquote>
<p>The default ranges are [1, 255], [256, 32767], and [32768, 2147483647].</p>
</blockquote>

<p><strong>Supplying a custom range</strong></p>

<p>To supply a custom range, customize an instance of the Fixture class with an instance of the <code>RandomNumericSequenceGenerator</code> and pass to its constructor a sequence of integer numbers (e.g. <code>-100, 100, 255</code>).</p>

<blockquote>
<p>The sequence must be two positive or negative numbers optionally followed by a series of greater numbers.</p>
</blockquote>
<pre class="highlight text">var fixture = new Fixture();
fixture.Customizations.Add(
    new RandomNumericSequenceGenerator(-100, 100, 255));

var i = fixture.CreateAnonymous&lt;int&gt;();
// Prints -&gt; -95
var l = fixture.CreateAnonymous&lt;long&gt;();
// Prints -&gt; 47
var f = fixture.CreateAnonymous&lt;float&gt;();
// Prints -&gt; -82.0
</pre>
<p>After applying the customization, numbers are now created in the range of [-100, 100]. However, when requesting more numbers than the range size the range is automatically changed to [101, 255].</p>
</div><div><br /><hr />Have feedback on this post? Let <a href="http://twitter.com/nikosbaxevanis" target="_blank">@nikosbaxevanis</a> know on Twitter.</div></div><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-24262928-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>