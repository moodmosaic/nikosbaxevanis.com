<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, user-scalable=no" name="viewport" /><title>Truly Constrained Non-Deterministic Numbers in AutoFixture</title><link href="http://fonts.googleapis.com/css?family=Lora:400,700|Open+Sans" rel="stylesheet" type="text/css" /><link href="/stylesheets/fontello.css?1391110042" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/styles.css?1391110042" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css?1391110042" media="screen" rel="stylesheet" type="text/css" /></head><body><div class="row"><h1>Truly Constrained Non-Deterministic Numbers in AutoFixture</h1><p>Numbers in <a href="https://github.com/autofixture/autofixture">AutoFixture</a> are currently created using a <strong>strictly monotonically increasing</strong> sequence.</p>
<pre class="highlight csharp">
<span class="n">var</span> <span class="n">fixture</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Fixture</span><span class="p">();</span>

<span class="n">var</span> <span class="n">i</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 1
</span><span class="n">var</span> <span class="n">l</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 2
</span><span class="n">var</span> <span class="n">f</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 3.0
</span></pre>
<p>Starting with version <em>2.13.0</em>, by applying a specific customization numbers can also be created using a <strong>constrained non-deterministic</strong> sequence. The new customization is called <code>RandomNumericSequenceCustomization</code>.</p>
<pre class="highlight csharp"><span class="n">var</span> <span class="n">fixture</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Fixture</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Customize</span><span class="p">(</span><span class="k">new</span> <span class="nf">RandomNumericSequenceCustomization</span><span class="p">());</span>

<span class="n">var</span> <span class="n">i</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 122
</span><span class="n">var</span> <span class="n">l</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 38
</span><span class="n">var</span> <span class="n">f</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 147.0
</span></pre>
<p>Once the customization has been applied to a <code>Fixture</code> instance subsequent requests for numeric types will yield random non-repeatable numbers in the range of [1, 255]. When requesting more than 255 numbers the range is automatically changed to [256, 32767] and so on.</p>

<blockquote>
<p>The default ranges are [1, 255], [256, 32767], and [32768, 2147483647].</p>
</blockquote>

<p><strong>Supplying a custom range</strong></p>

<p>To supply a custom range, customize an instance of the Fixture class with an instance of the <code>RandomNumericSequenceGenerator</code> and pass to its constructor a sequence of integer numbers (e.g. <code>-100, 100, 255</code>).</p>

<blockquote>
<p>The sequence must be two positive or negative numbers optionally followed by a series of greater numbers.</p>
</blockquote>
<pre class="highlight csharp"><span class="n">var</span> <span class="n">fixture</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Fixture</span><span class="p">();</span>
<span class="n">fixture</span><span class="p">.</span><span class="n">Customizations</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span>
    <span class="k">new</span> <span class="nf">RandomNumericSequenceGenerator</span><span class="p">(-</span><span class="m">100</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">255</span><span class="p">));</span>

<span class="n">var</span> <span class="n">i</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; -95
</span><span class="n">var</span> <span class="n">l</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; 47
</span><span class="n">var</span> <span class="n">f</span> <span class="p">=</span> <span class="n">fixture</span><span class="p">.</span><span class="n">CreateAnonymous</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;();</span>
<span class="c1">// Prints -&gt; -82.0
</span></pre>
<p>After applying the customization, numbers are now created in the range of [-100, 100]. However, when requesting more numbers than the range size the range is automatically changed to [101, 255].</p>
<a class="twitter" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fnikosbaxevanis.com%2Fblog%2F2012%2F10%2F08%2Ftruly-constrained-non-deterministic-numbers-in-autofixture%2F&text=Truly+Constrained+Non-Deterministic+Numbers+in+AutoFixture&via=nikosbaxevanis" target="_blank">Tweet This</a><div class="dater">October 08, 2012</div><div class="categories">Published in<a class="category" href="/category/autofixture/">AutoFixture&nbsp;</a> on October 08, 2012</div></div><div class="homer"><a href="/"><i class="icon-tape" style="font-size:32px;"></i></a></div><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-24262928-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>