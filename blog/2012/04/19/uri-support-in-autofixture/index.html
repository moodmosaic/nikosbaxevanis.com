<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, user-scalable=no" name="viewport" /><title>URI support in AutoFixture</title><link href="http://fonts.googleapis.com/css?family=Lora:400,700|Open+Sans" rel="stylesheet" type="text/css" /><link href="/stylesheets/fontello.css?1395747993" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/styles.css?1395747993" media="screen" rel="stylesheet" type="text/css" /></head><body><div class="row"><h1>URI support in AutoFixture</h1><div class="post"><p>Starting with version 2.10.0, AutoFixture supports the creation of <a href="http://en.wikipedia.org/wiki/Uniform_resource_identifier" target="_blank" title="In computing, a uniform resource identifier (URI) is a string of characters used to identify a name or a resource. Such identification enables interaction with representations of the resource over a network (typically the World Wide Web) using specific protocols. Schemes specifying a concrete syntax and associated protocols define each URI.">Uniform Resource Identifiers</a>&#0160;and the <a href="http://msdn.microsoft.com/en-us/library/system.uri(v=vs.90).aspx" target="_blank" title="Provides an object representation of a uniform resource identifier (URI) and easy access to the parts of the URI.">Uri</a>&#0160;type.</p>

<p>It is now possible to create an anonymous variable for Uri as with any other common type:</p>
<pre class="highlight text">var fixture = new Fixture();
var uri = fixture.CreateAnonymous&lt;Uri&gt;();
// Prints -&gt; scheme://257eb39a-8305-4d13-a7cb-0c481b78809a/
</pre>
<p>By default, both the <strong>scheme name</strong>&#0160;and the <strong>authority</strong>&#0160;part are obtained from the context. A custom&#0160;<em>UriScheme</em> class represents the URI scheme name while the authority&#0160;part is an anonymous variable of type string.</p>

<p>Example URIs along with their component parts can be found&#0160;<a href="http://en.wikipedia.org/wiki/URI_scheme#Examples" target="_blank">here</a>.&#0160;Since both parts are received from the context, they can be easily customized.</p>

<p><strong>Supplying a custom scheme name</strong></p>

<p>The UriScheme type provides by default the name <em>&ldquo;scheme&rdquo;.</em>&#0160;However, by injecting a specific instance of this type we can easily override it with something else (e.g. &ldquo;<em>http&rdquo;</em>).</p>
<pre class="highlight text">var fixture = new Fixture();
fixture.Inject(new UriScheme(&quot;http&quot;));
var uri = fixture.CreateAnonymous&lt;Uri&gt;(); 
// Prints -&gt; http://abc9f406-16f2-4e06-b6f9-0750dc115ac3/
</pre>
<p><strong>Supplying a custom authority</strong></p>

<blockquote>
<p>This is preferred only when each test constructs its own instance of the Fixture type since this change will apply for all the strings received from the context.</p>
</blockquote>

<p>Since the authority part is a string received from the context, it is possible to modify the base of all strings and get the desired name for the authority.</p>
<pre class="highlight text">var fixture = new Fixture();
fixture.Customizations.Add(
    new StringGenerator(() =&gt; &quot;autofixture.codeplex.com&quot;));
var uri = fixture.CreateAnonymous&lt;Uri&gt;(); 
// Prints -&gt; scheme://autofixture.codeplex.com/
</pre>
<p><strong>Supplying a custom Uri</strong></p>

<p>As with any other generated specimen, it is possible to completely take over it&#39;s creation. Using a custom&#0160;ISpecimenBuilder type, each time a Uri is requested, a predefined Uri will be returned.</p>
<pre class="highlight text">public class CustomUriBuilder : ISpecimenBuilder
{
    public object Create(object request, ISpecimenContext context)
    {
        if (request == typeof(Uri))
        {
            return new Uri(&quot;http://autofixture.codeplex.com&quot;);
        }

        return new NoSpecimen(request);
    }
}

var fixture = new Fixture();
fixture.Customizations.Add(new CustomUriBuilder());
var uri = fixture.CreateAnonymous&lt;Uri&gt;(); 
// Prints -&gt; http://autofixture.codeplex.com/
</pre>
<p>An automatically published release created from the latest successful build can be downloaded from&#0160;<a href="http://autofixture.codeplex.com/releases/view/85801" target="_blank" title="AutoFixture - Downloads">here</a>.&#0160;The latest version is also live on&#0160;<a href="http://nuget.org/List/Packages/AutoFixture" target="_blank" title="AutoFixture - Package">NuGet</a>.</p>
</div><div class="dater">April 19, 2012</div><div class="categories">Published in<a class="category" href="/category/autofixture/">AutoFixture&nbsp;</a> on April 19, 2012</div></div><div class="homer"><a href="/"><i class="icon-tape" style="font-size:32px;"></i></a></div><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-24262928-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>