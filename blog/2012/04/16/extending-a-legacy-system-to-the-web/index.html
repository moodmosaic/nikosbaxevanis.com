<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="width=device-width" name="viewport" /><title>Extending A Legacy System to the Web</title><link href="/images/favicon.ico" rel="icon" type="image/x-icon" /><link href="/feed" rel="alternate" type="application/rss+xml" /><link href="/stylesheets/blog.css?1388860351" media="screen" rel="stylesheet" type="text/css" /></head><body><body><div id="title"><div><h1><a href="/blog" style="color: #222">moodmosaic</a></h1><div><span>by </span><a href="/">Nikos Baxevanis </a><a href="http://creativecommons.org/licenses/by/3.0/" style="color: #877">(license)</a></div></div><div class="line"></div></div><div id="full"><h1><a>Extending A Legacy System to the Web</a></h1><div class="undertitle"><span class="date">Filed under </span><a class="tag" href="/blog#legacy-code">legacy-code</a></div><p>An ISV sells ordering and billing systems written in C/C++ and VB6. Each system is consisted of <em>two components&#0160;</em>and all&#0160;<em>share </em>a relational database&#0160;containing Tables, Views and Stored Procedures.</p>

<p><strong>A Legacy System</strong></p>

<p>The <em>server&#0160;</em>component does the data&#0160;<em>processing</em><em>, </em>accepting <strong>commands</strong> from the clients.&#0160;The commands are stored inside a&#0160;predefined directory&#0160;in the form of ASCII-encoded text files.&#0160;The legacy*&#0160;command processor repeatedly checks for new text file availability. If a text file is available, it will be processed. This is a continuous process.&#0160;The only way to update the database is to create and send a command which will be picked up and handled sequentially by the command processor.&#0160;When a command is handled successfully, the system updates the shared database.</p>

<p>The <em>client&#0160;</em>component connects to the shared <strong>database</strong> (accessed in a <strong>read-only</strong> fashion) to display data on screen and to send pre-defined commands. The client is either a VB6 GUI or a handheld radio device similar to <a href="http://www.orderman.com/en/handhelds/don.html" target="_blank">this one</a>.</p>

<p><img src="http://farm9.staticflickr.com/8465/8398554626_4e1f7962c3_o.png" alt="A legacy system" /></p>

<p>Nowdays, in order to reach the mobile market, it is quite difficult (and expensive) to maintain and expand the above client as-is. However, since each of the components has no knowledge of the other separate component,&#0160;<strong>the client can be easily replaced</strong>.</p>

<p><strong>Moving to HTTP services</strong></p>

<p>The new HTML5 client will consume HTTP services. A service here act as the entry point for creating the&#0160;ASCII-encoded text files which will be picked up by the legacy command processor.</p>

<p><img src="http://farm9.staticflickr.com/8047/8397465951_247d62192f_o.png" alt="Moving to HTTP services" /></p>

<p>When the application wants to submit data to be processed (by the legacy command processor) it sends a POST request. At this point, the new system creates a message which is send via a&#0160;<a href="http://www.eaipatterns.com/DatatypeChannel.html" target="_blank" title="By using a separate Datatype Channel for each type of data, all of the messages on a given channel will contain the same type of data. The sender, knowing what type the data is, will need to select the appropriate channel to send it on. The receiver, knowing what channel the data was received on, will know what its type is.">Datatype Channel</a>&#0160;to its receiver.</p>

<p>The receiver, of each particular message, forwards the processing of the command. A compatible text file is created, which will be picked up by the legacy command processor in order to update the database.</p>

<p>When the application wants to&#0160;retrieve data it sends a GET request. At that point, the&#0160;<a href="http://msdn.microsoft.com/en-us/library/system.web.http.apicontroller(v=vs.108).aspx" target="_blank">ApiController</a>&#0160;uses a&#0160;<a href="http://martinfowler.com/eaaCatalog/gateway.html" target="_blank" title="An object that encapsulates access to an external system or resource.">Gateway</a>&#0160;<em>(and internally&#0160;<a href="http://code.google.com/p/dapper-dot-net/" target="_blank" title="Dapper is a single file you can drop in to your project that will extend your IDbConnection interface. It is in production use at Stack Overflow.">Dapper</a>)</em> to access the shared database.</p>

<p>On refresh, the client sends a new GET request and the ApiController will return the updated data.</p>

<p><strong>Moving to Smartphones, Tablets and HTML5</strong></p>

<p>Now, the client&#0160;part has to be&#0160;<em>re-</em>built with HTML5. That way, it will be accessible from the browser, Internet Tablets (similar to&#0160;<a href="http://www.archos.com/products/ta/archos_43it/index.html?country=us&amp;lang=en" target="_blank">this one</a>), and&#0160;Smartphones.</p>

<p><img src="http://farm9.staticflickr.com/8324/8398554562_9909bb1f56_o.png" alt="Moving to Smartphones, Tablets and HTML5" /></p>

<p>Initially,&#0160;<a href="http://www.sencha.com/products/touch" target="_blank" title="Sencha Touch is a user interface (UI) JavaScript library, or framework, specifically built for Mobile Web.">Sencha Touch</a>&#0160;was a very good choice. <span style="text-decoration: line-through;">It even has a&#0160;<a href="http://www.sencha.com/blog/sencha-designer-2-beta-announcement" target="_blank">designer</a>.</span>&#0160;There is even <a href="http://www.sencha.com/products/architect/" target="_blank" title="A WYSIWYG IDE for Building Desktop and Mobile HTML5 Applications.">Sencha Architect</a>. Everything is written in JavaScript (which is good) and everything runs fast while testing on iPhone, iPad and other&#0160;similar devices with fast hardware.</p>

<p>The company however is willing to sell the final product to a price which includes the cost of the devices.&#0160;(That is, a license for 5 users should also include the purchase of 5 mobile devices.) This&#0160;means that the price for the devices can become orders of magnitude higher than the actual price of the application itself.</p>

<p>The above lead to the fact that the application must ship with a&#0160;<em>not-so-expensive</em>&#0160;device. After doing some testing and comparison with other devices, a Sencha Touch application did not perform smoothly in slower hardware (like&#0160;<a href="http://www.archos.com/products/ta/archos_43it/specs.html?country=us&amp;lang=en" target="_blank">this one</a>). (The most annoying part was the scrolling.)</p>

<p>After trying&#0160;<a href="http://addyosmani.github.com/todomvc/" target="_blank" title="TodoMVC: A common learning application for popular JavaScript MV* frameworks.">everything</a>&#0160;it looks like&#0160;<a href="http://jquerymobile.com/" target="_blank" title="jQuery Mobile: Touch-Optimized Web Framework for Smartphones &amp; Tablets.">jQuery Mobile</a>&#0160;combined with <a href="http://mustache.github.com/" target="_blank" title="Logic-less templates.  Available in Ruby, JavaScript, Python, Erlang, PHP, Perl, Objective-C, Java, .NET, Android, C++, Go, Lua, ooc, ActionScript, ColdFusion, Scala, Clojure, Fantom, CoffeeScript, D, and for node.js.">mustache</a>&#0160;are the best choices in terms of performance. The redistributable file is packed with&#0160;<a href="http://phonegap.com/" target="_blank" title="PhoneGap enables software programmers to build applications for mobile devices using JavaScript, HTML5 and CSS3, instead of lower-level languages.">PhoneGap</a>&#0160;and&#0160;the application performs well even on slower hardware giving the flexibility to select among a wide range of mobile devices.</p>

<p><span style="font-size: 8pt;">*&ldquo;<em>Legacy</em>&rdquo; The definition that&#0160;Michael C. Feathers gives in his excellent&#0160;<a href="http://www.amazon.com/Working-Effectively-Legacy-Michael-Feathers/dp/0131177052" target="_blank" title="Working Effectively with Legacy Code">book</a>.</span><span style="font-size: 11px;"><br /></span></p>
</div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'bonusbits';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script></body><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-24262928-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>