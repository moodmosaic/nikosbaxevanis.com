<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, user-scalable=no" name="viewport" /><title>TypeScript/Grunt/Angular</title><link href="http://fonts.googleapis.com/css?family=Lora:400,700|Open+Sans" rel="stylesheet" type="text/css" /><link href="/stylesheets/fontello.css?1400511466" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/styles.css?1400511466" media="screen" rel="stylesheet" type="text/css" /></head><body><div class="row"><h1>TypeScript/Grunt/Angular</h1><div class="post"><p><em>Since the TypeScript language is a strict superset of JavaScript, all the repetitive tasks like minification, compilation, unit testing, linting, etc, performed by Grunt can also be applied to TypeScript projects.</em></p>

<p>This post describes how to add <a href="http://www.typescriptlang.org/">TypeScript</a> to an <a href="http://angularjs.org/">AngularJS</a> project where task automation is performed by <a href="http://gruntjs.com/">Grunt</a>.</p>

<h3>Task automation pipeline</h3>

<p>Grunt processes a task automation pipeline defined in a <a href="http://gruntjs.com/getting-started#the-gruntfile">Gruntfile</a>. A sample Gruntfile is <a href="http://gruntjs.com/sample-gruntfile">available</a> from the Grunt website.</p>

<h3>Yeoman as a generator for task automation pipelines</h3>

<p>A more sophisticated Gruntfile, with reasonable defaults and best practises, is generated by <a href="http://yeoman.io">Yeoman</a> through <a href="https://github.com/yeoman/generator-angular">generator-angular</a>.</p>

<p>To make it easier to follow along, I will remove all globally installed npm modules on my machine:</p>
<pre class="highlight text"># http://stackoverflow.com/a/9283646/467754
npm -g ls | grep -v 'npm@' | awk '/@/ {print $2}' | awk -F@ '{print $1}' | xargs npm -g rm

# There are no globally installed npm modules:
npm list -g
C:\Users\Nikos\AppData\Roaming\npm
L-- (empty)
</pre>
<p>Install generator-angular:</p>
<pre class="highlight text">npm install -g generator-angular

# The following higher-level npm modules are globally installed:
npm list -g -depth=0
C:\Users\Nikos\AppData\Roaming\npm
├── bower@1.3.1
├── generator-angular@0.8.0
├── generator-karma@0.7.0
├── grunt-cli@0.1.13
└── yo@1.1.2
</pre>
<h3>Gruntfile generation</h3>

<p>Setting up a new AngularJS project through generator-angular generates all the boilerplate including the task automation pipeline (Gruntfile).</p>
<pre class="highlight text">yo angular [app-name]
</pre>
<blockquote>
<p>In case of any npm installation errors run &#39;npm cache clean [-g]&#39;.</p>
</blockquote>

<h3>Test runner configuration</h3>

<p>Install a <a href="https://github.com/karma-runner/karma-jasmine">karma adapter</a>, as well as a <a href="https://github.com/karma-runner/karma-chrome-launcher">browser launcher</a>:</p>
<pre class="highlight text">npm install karma-jasmine --save-dev
npm install karma-chrome-launcher --save-dev
</pre>
<p>Invoke Grunt via &#39;grunt serve&#39; and modify a test file. Any modification in the test files invokes <a href="http://karma-runner.github.io/">Karma</a>.</p>

<h3>TypeScript/Grunt installation</h3>

<p>Install the command-line TypeScript compiler:</p>
<pre class="highlight text">npm install -g typescript

# The following higher-level npm modules are globally installed:
npm list -g -depth=0
C:\Users\Nikos\AppData\Roaming\npm
├── bower@1.3.1
├── generator-angular@0.8.0
├── generator-karma@0.7.0
├── grunt-cli@0.1.13
├── typescript@0.9.7 &lt;--
└── yo@1.1.2
</pre>
<p>Install <a href="https://github.com/k-maru/grunt-typescript">grunt-typescript</a>:</p>
<pre class="highlight text">npm install grunt-typescript --save-dev
</pre>
<h3>TypeScript auto-compilation</h3>

<p>Rename all files with a <code>.js</code> extension to have a <code>.ts</code> extension and modify the Gruntfile:</p>
<pre class="highlight text">typescript: {
  base: {
    src: ['&lt;%= yeoman.app %&gt;/scripts/{,*/}*.ts'],
    options: {
      target: 'es5',
      sourceMap: true
    }
  },
  test: {
    src: ['test/spec/{,*/}*.ts'],
    options: {
      target: 'es5',
      sourceMap: true
    }
  }
},

...

ts: {
  files: ['&lt;%= yeoman.app %&gt;/scripts/{,*/}*.ts'],
  tasks: ['typescript']
},
tsTest: {
  files: ['test/spec/{,*/}*.ts'],
  tasks: ['typescript:test']
},
</pre>
<p>The file comparison output should be similar with the image shown below:</p>

<p><img alt="Image" src="/images/articles/2014-04-03-typescript-grunt-angular-1.png?1400511466" /></p>

<h3>Linting configuration</h3>

<p>Remove the indentation setting from JSHint since <a href="https://typescript.codeplex.com/workitem/204">TypeScript indents code idiomatically</a>.</p>

<p><img alt="Image" src="/images/articles/2014-04-03-typescript-grunt-angular-2.png?1400511466" /></p>

<h3>Declaration source files usage</h3>

<p>Most, if not all, of the TypeScript declaration source files are available by installing <a href="https://github.com/borisyankov/DefinitelyTyped">DefinitelyTyped</a>:</p>
<pre class="highlight text">bower install DefinitelyTyped --save-dev
</pre>
<p>Create an <code>_all.ts</code> declaration source file containing each necessary declaration:</p>
<pre class="highlight text">/// &lt;reference path='../bower_components/DefinitelyTyped/angularjs/angular.d.ts' /&gt;
/// &lt;reference path='controllers/main.ts' /&gt;
/// &lt;reference path='app.ts' /&gt;
</pre>
<blockquote>
<p>The &#39;_all.ts&#39; declaration source file is a convenient way of referencing all declaration sources in one line:
<code>/// &lt;reference path=&#39;[relative-path-to-all.ts-file]&#39; /&gt;</code></p>
</blockquote>

<p>A similar pattern can be applied to the test files:</p>
<pre class="highlight text">/// &lt;reference path='../../app/bower_components/DefinitelyTyped/angularjs/angular-mocks.d.ts' /&gt;
/// &lt;reference path='../../app/bower_components/DefinitelyTyped/jasmine/jasmine-1.3.d.ts' /&gt;
/// &lt;reference path='../../app/scripts/controllers/main.ts' /&gt;
</pre>
<h3>Coding in TypeScript</h3>

<p>The TypeScript language services is available as an official <a href="http://blogs.msdn.com/b/typescript/archive/2014/04/02/announcing-typescript-1-0.aspx">add-in for Visual Studio</a> as well as an unofficial, but rather excellent, <a href="https://github.com/Railk/T3S">add-in for Sublime Text</a>.</p>
</div><a class="twitter" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fnikosbaxevanis.com%2Fblog%2F2014%2F04%2F03%2Ftypescript-slash-grunt-slash-angular%2F&text=TypeScript%2FGrunt%2FAngular&via=nikosbaxevanis" target="_blank">Tweet This</a><div class="dater">April 03, 2014</div><div class="categories">Published in<a class="category" href="/category/javascript/">JavaScript&nbsp;</a></div></div><div class="homer"><a href="/"><i class="icon-tape" style="font-size:32px;"></i></a></div><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-24262928-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>